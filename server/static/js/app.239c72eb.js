(function(e){function n(n){for(var o,s,r=n[0],a=n[1],l=n[2],u=0,h=[];u<r.length;u++)s=r[u],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&h.push(i[s][0]),i[s]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);d&&d(n);while(h.length)h.shift()();return c.push.apply(c,l||[]),t()}function t(){for(var e,n=0;n<c.length;n++){for(var t=c[n],o=!0,r=1;r<t.length;r++){var a=t[r];0!==i[a]&&(o=!1)}o&&(c.splice(n--,1),e=s(s.s=t[0]))}return e}var o={},i={app:0},c=[];function s(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=o,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)s.d(t,o,function(n){return e[n]}.bind(null,o));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=n,r=r.slice();for(var l=0;l<r.length;l++)n(r[l]);var d=a;c.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"396f":function(e,n,t){},"4ca4":function(e,n,t){},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var o=t("7a23");t("b0c0");function i(e,n,t,i,c,s){var r=Object(o["m"])("HomeMenu"),a=Object(o["m"])("Game");return c.gameNotStart?(Object(o["h"])(),Object(o["c"])(r,{key:0,name:c.user.name,skin:c.user.skin},null,8,["name","skin"])):(Object(o["h"])(),Object(o["c"])(a,Object(o["g"])({key:1},c.user,{onEnd:s.goMenu}),null,16,["onEnd"]))}var c=Object(o["q"])("data-v-74c4c2e2");Object(o["j"])("data-v-74c4c2e2");var s={id:"menupage",class:"middle"},r=Object(o["f"])("button",{id:"setting"},null,-1),a=Object(o["f"])("h2",null,"Corona.io",-1);Object(o["i"])();var l=c((function(e,n,t,i,l,d){var u=Object(o["m"])("skin-window"),h=Object(o["m"])("skin-choose"),f=Object(o["m"])("base-block");return Object(o["h"])(),Object(o["c"])("div",s,[l.openDialog?(Object(o["h"])(),Object(o["c"])(u,{key:0,skin:t.skin,colorList:l.colorList,onCloseWindow:d.updateSkin},null,8,["skin","colorList","onCloseWindow"])):Object(o["d"])("",!0),Object(o["f"])(f,{class:"middle"},{default:c((function(){return[r,a,Object(o["f"])(h,{onClick:d.openWindow,skin:l.inputSkin},null,8,["onClick","skin"]),Object(o["p"])(Object(o["f"])("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=function(e){return t.name=e}),placeholder:"Nick"},null,512),[[o["o"],t.name]]),Object(o["f"])("button",{id:"play",onClick:n[2]||(n[2]=function(e){return d.play(t.name,l.inputSkin)})},"Play")]})),_:1})])})),d=Object(o["q"])("data-v-8a5f9842"),u=d((function(e,n,t,i,c,s){return Object(o["h"])(),Object(o["c"])("span",null,[Object(o["f"])("button",{style:[t.skin?{backgroundColor:t.skin,"border-style":"none",color:"white"}:{"border-style":"dashed"}]}," Skin ",4)])})),h={props:["skin"],date:function(){return{}}};t("94f6");h.render=u,h.__scopeId="data-v-8a5f9842";var f=h,b=Object(o["q"])("data-v-5a6465dd");Object(o["j"])("data-v-5a6465dd");var p=Object(o["f"])("div",null,null,-1),m=Object(o["f"])("header",null,[Object(o["f"])("h2",null,"Available Skins")],-1);Object(o["i"])();var v=b((function(e,n,t,i,c,s){var r=Object(o["m"])("circle-button");return Object(o["h"])(),Object(o["c"])(o["a"],null,[p,Object(o["f"])("dialog",{open:"",class:{moveCen:c.move}},[m,Object(o["f"])("button",{onClick:n[1]||(n[1]=function(){return s.finish&&s.finish.apply(s,arguments)}),id:"close"},"x"),Object(o["f"])("section",null,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["k"])(t.colorList,(function(e){return Object(o["h"])(),Object(o["c"])(r,{onClick:function(n){return s.updateSkin(e)},color:e,key:e},null,8,["onClick","color"])})),128))])],2)],64)})),j={props:["skin","colorList"],emits:["closeWindow"],methods:{finish:function(){this.$emit("closeWindow",this.inputSkin)},updateSkin:function(e){this.inputSkin=e,this.finish()},handleResize:function(){window.innerWidth/10>76.7?this.move=!1:this.move=!0}},data:function(){return{inputSkin:this.skin,move:!0}},mounted:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},unmounted:function(){window.removeEventListener("resize",this.handleResize)}};t("b928");j.render=v,j.__scopeId="data-v-5a6465dd";var O=j,w={components:{"skin-window":O,"skin-choose":f},props:["name","skin"],data:function(){return{openDialog:!1,colorList:["#f5da42","#42c2f5","#f54242","#cef542","#f59b42"],inputSkin:this.skin}},inject:["play"],methods:{updateSkin:function(e){this.inputSkin=e,this.openDialog=!1},openWindow:function(){this.openDialog=!0}}};t("ceec");w.render=l,w.__scopeId="data-v-74c4c2e2";var y=w,x=Object(o["q"])("data-v-bf9b581c");Object(o["j"])("data-v-bf9b581c");var g=Object(o["f"])("canvas",{id:"canvas"},null,-1),_=Object(o["f"])("h3",null,"Leaderboard",-1),k={class:"left"},S={class:"right"};Object(o["i"])();var W=x((function(e,n,t,i,c,s){var r=Object(o["m"])("die-window"),a=Object(o["m"])("base-block");return Object(o["h"])(),Object(o["c"])(o["a"],null,[g,c.die?(Object(o["h"])(),Object(o["c"])(r,{key:0,score:c.max_score,onCloseWindow:s.replay},null,8,["score","onCloseWindow"])):Object(o["d"])("",!0),Object(o["f"])(a,{id:"leaderboard"},{default:x((function(){return[_,Object(o["f"])("ol",null,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["k"])(c.leader,(function(e){return Object(o["h"])(),Object(o["c"])("li",{key:e.name},[Object(o["f"])("span",k,Object(o["n"])(e.name),1),Object(o["f"])("span",S,Object(o["n"])(e.score),1)])})),128))])]})),_:1}),Object(o["f"])(a,{id:"score"},{default:x((function(){return[Object(o["e"])(" Score : "+Object(o["n"])(c.score),1)]})),_:1}),Object(o["f"])("button",{id:"exit",onClick:n[1]||(n[1]=function(){return s.ends&&s.ends.apply(s,arguments)})},"X")],64)})),C=(t("cb29"),t("4160"),t("a434"),t("4ec9"),t("d3b7"),t("3ca3"),t("159b"),t("ddb0"),Object(o["q"])("data-v-b93e2284"));Object(o["j"])("data-v-b93e2284");var M=Object(o["f"])("div",null,null,-1);Object(o["i"])();var z=C((function(e,n,t,i,c,s){return Object(o["h"])(),Object(o["c"])(o["a"],null,[M,Object(o["f"])("dialog",{open:"",class:{moveCen:c.move}},[Object(o["f"])("header",null,[Object(o["f"])("h2",null,"Your final score : "+Object(o["n"])(t.score),1)]),Object(o["f"])("section",null,[Object(o["f"])("button",{id:"again",onClick:n[1]||(n[1]=function(){return s.again&&s.again.apply(s,arguments)})},"Play Again"),Object(o["f"])("button",{id:"close",onClick:n[2]||(n[2]=function(){return s.finish&&s.finish.apply(s,arguments)})},"Main Menu")])],2)],64)})),P={props:["score"],emits:["closeWindow"],methods:{finish:function(){this.$emit("closeWindow",!1)},again:function(){this.$emit("closeWindow",!0)},handleResize:function(){window.innerWidth/10>76.7?this.move=!1:this.move=!0}},data:function(){return{move:!0}},mounted:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},unmounted:function(){window.removeEventListener("resize",this.handleResize)}};t("a290");P.render=z,P.__scopeId="data-v-b93e2284";var I=P,H={components:{"die-window":I},props:["name","skin"],emits:["end"],data:function(){return{score:10,leader:[],connection:null,interval:null,mouse_x:0,mouse_y:0,action:!1,id:null,canvas:null,ctx:null,dpi:null,screen_x:0,screen_y:0,alive:!0,timer:0,foods:new Map,theta:0,prev_x:-999,prev_y:-999,step:3,step_size:2,step_interval:10,px:0,py:0,die:!1,max_score:10,border:[{x:-1e3,y:-1e3},{x:1e3,y:1e3}]}},created:function(){var e=this;console.log("Starting connection to WebSocket Server"),this.connection=new WebSocket("wss://"+ document.domain + "/agar"),this.connection.onmessage=function(n){var t=JSON.parse(n.data);e.perForm(t)},this.connection.onopen=function(n){console.log("Successfully connected to the echo websocket server...");var t={cmd:"join_room",info:{name:e.name,skin:e.skin,room:"test"}};e.sendUser(t),window.onmousemove=function(n){e.mouse_x=n.pageX-e.screen_x,e.mouse_y=n.pageY-e.screen_y,e.theta=Math.atan2(e.mouse_y,e.mouse_x)},window.onresize=function(n){e.screen_x=Math.floor(window.innerWidth/2),e.screen_y=Math.floor(window.innerHeight/2),console.log(2*e.screen_x),e.canvas.width=window.innerWidth,e.canvas.height=window.innerHeight},window.onresize(),window.onkeydown=function(n){32==n.keyCode&&(e.action=!0)},e.interval=setInterval((function(){var n={cmd:"blob_move",info:{xpos:e.mouse_x,ypos:-e.mouse_y,action:e.action}};e.sendUser(n),e.action&&(e.action=!1)}),150)},this.connection.onclose=function(e){console.log("closing")}},mounted:function(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.dpi=window.devicePixelRatio},methods:{startGame:function(){var e=this;console.log("Starting connection to WebSocket Server"),this.connection=new WebSocket("wss://b1ed91c80ddc.ngrok.io/agar"),this.connection.onmessage=function(n){var t=JSON.parse(n.data);e.perForm(t)},this.connection.onopen=function(n){console.log("Successfully connected to the echo websocket server...");var t={cmd:"join_room",info:{name:e.name,skin:e.skin,room:"test"}};e.sendUser(t),window.onmousemove=function(n){e.mouse_x=n.pageX-e.screen_x,e.mouse_y=n.pageY-e.screen_y,e.theta=Math.atan2(e.mouse_y,e.mouse_x)},window.onresize=function(n){e.screen_x=Math.floor(window.innerWidth/2),e.screen_y=Math.floor(window.innerHeight/2),console.log(2*e.screen_x),e.canvas.width=window.innerWidth,e.canvas.height=window.innerHeight},window.onresize(),window.onkeydown=function(n){32==n.keyCode&&(e.action=!0)},e.interval=setInterval((function(){var n={cmd:"blob_move",info:{xpos:e.mouse_x,ypos:-e.mouse_y,action:e.action}};e.sendUser(n),e.action&&(e.action=!1)}),150)},this.connection.onclose=function(e){console.log("closing")}},perForm:function(e){var n=performance.now();this.timer,"players"==e.cmd?(-999!=this.prev_y&&(this.px=(e.info.me.xpos-this.prev_x)/this.step,this.py=(e.info.me.ypos-this.prev_y)/this.step),this.updateBoard(e.info.leader_board),this.addFood(e.info.food_add),this.delFood(e.info.food_del),this.draw(e.info,0),this.updateHighScore(this.score)):"init_info"==e.cmd?(this.addFood(e.info.food),this.updateBorder(e.info.border),console.log("food-coming!"),console.log(this.foods)):console.log("no cmd matching! "+e.cmd);performance.now();this.timer=n},sendUser:function(e){this.connection.send(JSON.stringify(e))},ends:function(){clearInterval(this.interval),this.interval=null,this.score=10,null!=this.connection&&(this.connection.close(),this.connection=null),this.$emit("end")},replay:function(e){this.die=!1,e?(clearInterval(this.interval),this.interval=null,this.score=10,this.max_score=10,this.foods.clear(),this.alive=!0,null!=this.connection&&(this.connection.close(),this.connection=null),this.startGame()):this.ends()},updateBoard:function(e){for(var n=0,t=e.length;n<5;n++){if(!(n<t)){this.leader.splice(n,4-n+1);break}this.leader.splice(n,1,e[n])}},draw:function(e,n){var t=this;for(var o in this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),e.me.alive||0!=this.die||(clearInterval(this.interval),this.interval=null,this.die=!0),this.foods.forEach((function(n){t.plotBlob(t.screen_x+n.xpos-e.me.xpos,t.screen_y-(n.ypos-e.me.ypos),n.skin)})),this.score=e.me.score,e.me.blobs)this.plotBlob(this.screen_x+e.me.blobs[o].xpos-e.me.xpos,this.screen_y-(e.me.blobs[o].ypos-e.me.ypos),this.skin,e.me.blobs[o].radius,this.name);for(var i in this.plotWall(e.me.xpos,e.me.ypos),e.blobs)this.plotBlob(this.screen_x+e.blobs[i].xpos-e.me.xpos,this.screen_y-(e.blobs[i].ypos-e.me.ypos),e.blobs[i].skin,e.blobs[i].radius,e.blobs[i].name);if(n<this.step&&e.me.alive){var c=Math.atan2(-this.mouse_y,this.mouse_x),s=this.step_size*Math.cos(c),r=this.step_size*Math.sin(c),a=0,l=0,d=0;for(var u in e.me.blobs)e.me.blobs[u].xpos+=s,e.me.blobs[u].ypos+=r,a+=e.me.blobs[u].xpos,l+=e.me.blobs[u].ypos,d+=1;e.me.xpos=a/d,e.me.ypos=l/d,setTimeout(this.draw(e,n+1),this.step_interval)}},addFood:function(e){for(var n in e)this.foods.set(n,{xpos:e[n].xpos,ypos:e[n].ypos,skin:e[n].skin})},delFood:function(e){var n=this;e.forEach((function(e){n.foods.delete(e)}))},plotBlob:function(e,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"5",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.ctx.beginPath(),this.ctx.arc(e,n,o,0,2*Math.PI,!1),this.ctx.font="16px Helvetica",this.ctx.textAlign="center",this.ctx.textBaseLine="middle",this.ctx.fillStyle=t,this.ctx.fill(),this.ctx.beginPath(),this.ctx.fillStyle="#ffffff",this.ctx.fillText(i,e,n+3),this.ctx.fill()},plotWall:function(e,n){n+this.screen_y>this.border[1].y&&(this.ctx.beginPath(),this.ctx.rect(0,0,window.innerWidth,n+this.screen_y-this.border[1].y),this.ctx.fillStyle="#ffffff",this.ctx.fill()),e+this.screen_x>this.border[1].x&&(this.ctx.beginPath(),this.ctx.rect(window.innerWidth-(e+this.screen_x-this.border[1].x),0,window.innerWidth,window.innerHeight),this.ctx.fillStyle="#ffffff",this.ctx.fill()),e-this.screen_x<this.border[0].x&&(this.ctx.beginPath(),this.ctx.rect(0,0,this.border[0].x-(e-this.screen_x),window.innerHeight),this.ctx.fillStyle="#ffffff",this.ctx.fill()),n-this.screen_y<this.border[0].y&&(this.ctx.beginPath(),this.ctx.rect(0,window.innerHeight-(this.border[0].y-(n-this.screen_y)),window.innerWidth,window.innerHeight),this.ctx.fillStyle="#ffffff",this.ctx.fill())},updateHighScore:function(e){e>this.max_score&&(this.max_score=e)},updateBorder:function(e){console.log(e);for(var n=0,t=e.length;n<t;n++)this.border.splice(n,1,e[n])}}};t("b1ea");H.render=W,H.__scopeId="data-v-bf9b581c";var L=H,B={data:function(){return{user:{name:"",skin:""},gameNotStart:!0}},components:{HomeMenu:y,Game:L},methods:{play:function(e,n){this.user.name=e,this.user.skin=n,this.gameNotStart=!1},goMenu:function(){this.gameNotStart=!0}},provide:function(){return{play:this.play}}};t("d3b5");B.render=i;var R=B,E=Object(o["q"])("data-v-0791e1c2");Object(o["j"])("data-v-0791e1c2");var F={class:"block"};Object(o["i"])();var N=E((function(e,n,t,i,c,s){return Object(o["h"])(),Object(o["c"])("div",F,[Object(o["l"])(e.$slots,"default")])})),q={};t("c92d");q.render=N,q.__scopeId="data-v-0791e1c2";var U=q,$=Object(o["q"])("data-v-9712b488"),J=$((function(e,n,t,i,c,s){return Object(o["h"])(),Object(o["c"])("span",null,[Object(o["f"])("button",{style:{backgroundColor:t.color}},[Object(o["l"])(e.$slots,"default")],4)])})),D={props:["color"]};t("d8e9");D.render=J,D.__scopeId="data-v-9712b488";var G=D,T=Object(o["b"])(R);T.component("base-block",U),T.component("circle-button",G),T.mount("#app")},"5aa5":function(e,n,t){},"94f6":function(e,n,t){"use strict";t("396f")},a290:function(e,n,t){"use strict";t("e101")},b138:function(e,n,t){},b1ea:function(e,n,t){"use strict";t("e829")},b928:function(e,n,t){"use strict";t("5aa5")},c92d:function(e,n,t){"use strict";t("b138")},ceec:function(e,n,t){"use strict";t("4ca4")},d298:function(e,n,t){},d3b5:function(e,n,t){"use strict";t("d298")},d8e9:function(e,n,t){"use strict";t("fc8b")},e101:function(e,n,t){},e829:function(e,n,t){},fc8b:function(e,n,t){}});
//# sourceMappingURL=app.239c72eb.js.map
