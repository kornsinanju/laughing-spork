(function(e){function n(n){for(var o,s,r=n[0],a=n[1],l=n[2],d=0,f=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(c,s)&&c[s]&&f.push(c[s][0]),c[s]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);u&&u(n);while(f.length)f.shift()();return i.push.apply(i,l||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],o=!0,r=1;r<t.length;r++){var a=t[r];0!==c[a]&&(o=!1)}o&&(i.splice(n--,1),e=s(s.s=t[0]))}return e}var o={},c={app:0},i=[];function s(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=o,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)s.d(t,o,function(n){return e[n]}.bind(null,o));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],a=r.push.bind(r);r.push=n,r=r.slice();for(var l=0;l<r.length;l++)n(r[l]);var u=a;i.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"396f":function(e,n,t){},4561:function(e,n,t){},"4ca4":function(e,n,t){},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var o=t("7a23");t("b0c0");function c(e,n,t,c,i,s){var r=Object(o["m"])("HomeMenu"),a=Object(o["m"])("Game");return i.gameNotStart?(Object(o["h"])(),Object(o["c"])(r,{key:0,name:i.user.name,skin:i.user.skin},null,8,["name","skin"])):(Object(o["h"])(),Object(o["c"])(a,Object(o["g"])({key:1},i.user,{onEnd:s.goMenu}),null,16,["onEnd"]))}var i=Object(o["q"])("data-v-74c4c2e2");Object(o["j"])("data-v-74c4c2e2");var s={id:"menupage",class:"middle"},r=Object(o["f"])("button",{id:"setting"},null,-1),a=Object(o["f"])("h2",null,"Corona.io",-1);Object(o["i"])();var l=i((function(e,n,t,c,l,u){var d=Object(o["m"])("skin-window"),f=Object(o["m"])("skin-choose"),b=Object(o["m"])("base-block");return Object(o["h"])(),Object(o["c"])("div",s,[l.openDialog?(Object(o["h"])(),Object(o["c"])(d,{key:0,skin:t.skin,colorList:l.colorList,onCloseWindow:u.updateSkin},null,8,["skin","colorList","onCloseWindow"])):Object(o["d"])("",!0),Object(o["f"])(b,{class:"middle"},{default:i((function(){return[r,a,Object(o["f"])(f,{onClick:u.openWindow,skin:l.inputSkin},null,8,["onClick","skin"]),Object(o["p"])(Object(o["f"])("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=function(e){return t.name=e}),placeholder:"Nick"},null,512),[[o["o"],t.name]]),Object(o["f"])("button",{id:"play",onClick:n[2]||(n[2]=function(e){return u.play(t.name,l.inputSkin)})},"Play")]})),_:1})])})),u=Object(o["q"])("data-v-8a5f9842"),d=u((function(e,n,t,c,i,s){return Object(o["h"])(),Object(o["c"])("span",null,[Object(o["f"])("button",{style:[t.skin?{backgroundColor:t.skin,"border-style":"none",color:"white"}:{"border-style":"dashed"}]}," Skin ",4)])})),f={props:["skin"],date:function(){return{}}};t("94f6");f.render=d,f.__scopeId="data-v-8a5f9842";var b=f,h=Object(o["q"])("data-v-5a6465dd");Object(o["j"])("data-v-5a6465dd");var p=Object(o["f"])("div",null,null,-1),v=Object(o["f"])("header",null,[Object(o["f"])("h2",null,"Available Skins")],-1);Object(o["i"])();var m=h((function(e,n,t,c,i,s){var r=Object(o["m"])("circle-button");return Object(o["h"])(),Object(o["c"])(o["a"],null,[p,Object(o["f"])("dialog",{open:"",class:{moveCen:i.move}},[v,Object(o["f"])("button",{onClick:n[1]||(n[1]=function(){return s.finish&&s.finish.apply(s,arguments)}),id:"close"},"x"),Object(o["f"])("section",null,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["k"])(t.colorList,(function(e){return Object(o["h"])(),Object(o["c"])(r,{onClick:function(n){return s.updateSkin(e)},color:e,key:e},null,8,["onClick","color"])})),128))])],2)],64)})),j={props:["skin","colorList"],emits:["closeWindow"],methods:{finish:function(){this.$emit("closeWindow",this.inputSkin)},updateSkin:function(e){this.inputSkin=e,this.finish()},handleResize:function(){window.innerWidth/10>76.7?this.move=!1:this.move=!0}},data:function(){return{inputSkin:this.skin,move:!0}},mounted:function(){window.addEventListener("resize",this.handleResize),this.handleResize()},unmounted:function(){window.removeEventListener("resize",this.handleResize)}};t("b928");j.render=m,j.__scopeId="data-v-5a6465dd";var O=j,k={components:{"skin-window":O,"skin-choose":b},props:["name","skin"],data:function(){return{openDialog:!1,colorList:["#f5da42","#42c2f5","#f54242","#cef542","#f59b42"],inputSkin:this.skin}},inject:["play"],methods:{updateSkin:function(e){this.inputSkin=e,this.openDialog=!1},openWindow:function(){this.openDialog=!0}}};t("ceec");k.render=l,k.__scopeId="data-v-74c4c2e2";var y=k,w=Object(o["q"])("data-v-7a330a12");Object(o["j"])("data-v-7a330a12");var g=Object(o["f"])("canvas",{id:"canvas"},null,-1),x=Object(o["f"])("h3",null,"Leaderboard",-1),_={class:"left"},S={class:"right"};Object(o["i"])();var C=w((function(e,n,t,c,i,s){var r=Object(o["m"])("base-block");return Object(o["h"])(),Object(o["c"])(o["a"],null,[g,Object(o["f"])(r,{id:"leaderboard"},{default:w((function(){return[x,Object(o["f"])("ol",null,[(Object(o["h"])(!0),Object(o["c"])(o["a"],null,Object(o["k"])(i.leader,(function(e){return Object(o["h"])(),Object(o["c"])("li",{key:e.name},[Object(o["f"])("span",_,Object(o["n"])(e.name),1),Object(o["f"])("span",S,Object(o["n"])(e.score),1)])})),128))])]})),_:1}),Object(o["f"])(r,{id:"score"},{default:w((function(){return[Object(o["e"])(" Score : "+Object(o["n"])(i.score),1)]})),_:1}),Object(o["f"])("button",{id:"exit",onClick:n[1]||(n[1]=function(){return s.end&&s.end.apply(s,arguments)})},"X")],64)})),P=(t("cb29"),t("4160"),t("4ec9"),t("d3b7"),t("3ca3"),t("159b"),t("ddb0"),{props:["name","skin"],emits:["end"],data:function(){return{score:10,leader:[{name:"John",score:5e5},{name:"PP",score:5e4},{name:"KK",score:1e4},{name:"Hello",score:1e3},{name:"Moo",score:100}],connection:null,interval:null,mouse_x:0,mouse_y:0,action:!1,id:null,canvas:null,ctx:null,dpi:null,screen_x:0,screen_y:0,alive:!0,timer:0,foods:new Map}},created:function(){var e=this;console.log("Starting connection to WebSocket Server"),this.connection=new WebSocket("wss://6e7199a27e3d.ngrok.io/ws/game/"),this.connection.onmessage=function(n){var t=performance.now();0!=e.timer&&console.log("Interval between on message "+(t-e.timer)+" milliseconds.");var o=JSON.parse(n.data);"players"==o.cmd?e.draw(o.info):"food-add"==o.cmd?(e.addFood(o.info),console.log("food-coming!"),console.log(e.foods)):"food-del"==o.cmd?e.delFood(o.info):console.log("no cmd matching! "+o.cmd);var c=performance.now();console.log("Call to draw took "+(c-t)+" milliseconds."),e.timer=t},this.connection.onopen=function(n){console.log("Successfully connected to the echo websocket server...");var t={cmd:"join_room",info:{name:e.name,skin:e.skin,room:"test"}};e.sendUser(t),window.onmousemove=function(n){e.mouse_x=n.pageX-e.screen_x,e.mouse_y=n.pageY-e.screen_y},window.onresize=function(n){e.screen_x=Math.floor(window.innerWidth/2),e.screen_y=Math.floor(window.innerHeight/2),console.log(2*e.screen_x),e.canvas.width=window.innerWidth,e.canvas.height=window.innerHeight},window.onresize(),window.onkeydown=function(n){32==n.keyCode&&(e.action=!0)},e.interval=setInterval((function(){var n={cmd:"blob_move",info:{xpos:e.mouse_x,ypos:-e.mouse_y,action:e.action}};e.sendUser(n),e.action&&(e.action=!1)}),150)}},mounted:function(){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.dpi=window.devicePixelRatio},methods:{sendUser:function(e){this.connection.send(JSON.stringify(e))},end:function(){clearInterval(this.interval),this.interval=null,this.score=10,this.connection.close(),this.connection=null,this.$emit("end")},draw:function(e){var n=this;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var t=e.me;for(var o in t.alive||this.end(),this.foods.forEach((function(e){n.plotBlob(n.screen_x+e.xpos-t.ave_xpos,n.screen_y+e.ypos-t.ave_ypos,e.skin)})),this.score=t.score,t.blobs)this.plotBlob(this.screen_x+t.blobs[o].xpos-t.ave_xpos,this.screen_y+t.blobs[o].ypos-t.ave_ypos,this.skin,t.blobs[o].radius,this.name);for(var c in e.blobs)this.plotBlob(this.screen_x+e.blobs[c].xpos-t.ave_xpos,this.screen_y+e.blobs[c].ypos-t.ave_ypos,e.blobs[c].skin,e.blobs[c].radius,e.blobs[c].name)},addFood:function(e){var n=this;e.foods.forEach((function(e){n.foods.set(e.id,{xpos:e.xpos,ypos:e.ypos,skin:e.skin})}))},delFood:function(e){var n=this;e.foodsId.forEach((function(e){n.foods.delete(e)}))},plotBlob:function(e,n,t){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"5",c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";this.ctx.beginPath(),this.ctx.arc(e,n,o,0,2*Math.PI,!1),this.ctx.font="16px Helvetica",this.ctx.textAlign="center",this.ctx.textBaseLine="middle",this.ctx.fillStyle=t,this.ctx.fill(),this.ctx.beginPath(),this.ctx.fillStyle="#ffffff",this.ctx.fillText(c,e,n+3),this.ctx.fill()}}});t("5fca");P.render=C,P.__scopeId="data-v-7a330a12";var M=P,I={data:function(){return{user:{name:"",skin:""},gameNotStart:!0}},components:{HomeMenu:y,Game:M},methods:{play:function(e,n){this.user.name=e,this.user.skin=n,this.gameNotStart=!1},goMenu:function(){this.gameNotStart=!0}},provide:function(){return{play:this.play}}};t("d3b5");I.render=c;var W=I,L=Object(o["q"])("data-v-0791e1c2");Object(o["j"])("data-v-0791e1c2");var z={class:"block"};Object(o["i"])();var E=L((function(e,n,t,c,i,s){return Object(o["h"])(),Object(o["c"])("div",z,[Object(o["l"])(e.$slots,"default")])})),N={};t("c92d");N.render=E,N.__scopeId="data-v-0791e1c2";var q=N,B=Object(o["q"])("data-v-9712b488"),H=B((function(e,n,t,c,i,s){return Object(o["h"])(),Object(o["c"])("span",null,[Object(o["f"])("button",{style:{backgroundColor:t.color}},[Object(o["l"])(e.$slots,"default")],4)])})),R={props:["color"]};t("d8e9");R.render=H,R.__scopeId="data-v-9712b488";var J=R,D=Object(o["b"])(W);D.component("base-block",q),D.component("circle-button",J),D.mount("#app")},"5aa5":function(e,n,t){},"5fca":function(e,n,t){"use strict";t("4561")},"94f6":function(e,n,t){"use strict";t("396f")},b138:function(e,n,t){},b928:function(e,n,t){"use strict";t("5aa5")},c92d:function(e,n,t){"use strict";t("b138")},ceec:function(e,n,t){"use strict";t("4ca4")},d298:function(e,n,t){},d3b5:function(e,n,t){"use strict";t("d298")},d8e9:function(e,n,t){"use strict";t("fc8b")},fc8b:function(e,n,t){}});
//# sourceMappingURL=app.bebf9d9e.js.map